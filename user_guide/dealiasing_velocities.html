
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Radar Data Quality Control - Dealiasing &#8212; PyDDA 1.3.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Converting the radar data to Cartesian coordinates with Py-ART" href="gridding.html" />
    <link rel="prev" title="Reading in Radar Data in Native Radial Coordinates" href="read_radar_data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">PyDDA</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../contributors_guide/index.html">
  Contributor’s Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../source/auto_examples/index.html">
  PyDDA Example Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../dev_reference/index.html">
  Developer Reference Manual
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="read_radar_data.html">
   Reading in Radar Data in Native Radial Coordinates
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Radar Data Quality Control - Dealiasing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gridding.html">
   Converting the radar data to Cartesian coordinates with Py-ART
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-the-data">
   Read the Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-velocity-of-both-radars">
     Plot Velocity of Both Radars
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#determining-artifacts-within-doppler-velocities">
   Determining Artifacts within Doppler Velocities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity-texture-displays">
     Velocity Texture Displays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filter-doppler-velocity-artifacts">
     Filter Doppler Velocity Artifacts
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-dealiasing">
   Apply Dealiasing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-corrected-velocity-fields">
     Display Corrected Velocity Fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="radar-data-quality-control-dealiasing">
<span id="dealiasing-velocities"></span><h1>Radar Data Quality Control - Dealiasing<a class="headerlink" href="#radar-data-quality-control-dealiasing" title="Permalink to this headline">#</a></h1>
<p>In this notebook, we will showcase how to preform quality control of your
radar files, specifically dealiasing velocities. By doing this we can provide
PyDDA with quality controlled doppler velocities for dual doppler analysis.</p>
<section id="read-the-data">
<h2>Read the Data<a class="headerlink" href="#read-the-data" title="Permalink to this headline">#</a></h2>
<p>For this example, we use test data found in Py-ART for two X-Band Scanning ARM
Precipitation Radars (X-SAPR) found at the Atmospheric Radiation Measurment
(ARM) Southern Great Plains (SGP) site in Oklahoma. For more information on
reading the radar data, consult <a class="reference internal" href="read_radar_data.html#reading-radar-data"><span class="std std-ref">Reading in Radar Data in Native Radial Coordinates</span></a>.</p>
<dl class="simple">
<dt>Get test data::</dt><dd><p><a class="reference external" href="https://arm-doe.github.io/pyart/API/generated/pyart.testing.get_test_data.html">https://arm-doe.github.io/pyart/API/generated/pyart.testing.get_test_data.html</a></p>
</dd>
<dt>Reading CF-Radial::</dt><dd><p><a class="reference external" href="https://arm-doe.github.io/pyart/API/generated/pyart.io.read_cfradial.html">https://arm-doe.github.io/pyart/API/generated/pyart.io.read_cfradial.html</a></p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the data from both XSAPR radars</span>
<span class="n">xsapr_sw_file</span> <span class="o">=</span> <span class="n">get_test_data</span><span class="p">(</span><span class="s2">&quot;swx_20120520_0641.nc&quot;</span><span class="p">)</span>
<span class="n">xsapr_se_file</span> <span class="o">=</span> <span class="n">get_test_data</span><span class="p">(</span><span class="s2">&quot;sex_20120520_0641.nc&quot;</span><span class="p">)</span>
<span class="n">radar_sw</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cfradial</span><span class="p">(</span><span class="n">xsapr_sw_file</span><span class="p">)</span>
<span class="n">radar_se</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cfradial</span><span class="p">(</span><span class="n">xsapr_se_file</span><span class="p">)</span>
</pre></div>
</div>
<section id="plot-velocity-of-both-radars">
<h3>Plot Velocity of Both Radars<a class="headerlink" href="#plot-velocity-of-both-radars" title="Permalink to this headline">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Plot the southwestern radar</span>
<span class="n">disp1</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">RadarMapDisplay</span><span class="p">(</span><span class="n">radar_sw</span><span class="p">)</span>
<span class="n">disp1</span><span class="o">.</span><span class="n">plot_ppi_map</span><span class="p">(</span>
    <span class="s2">&quot;mean_doppler_velocity&quot;</span><span class="p">,</span>
    <span class="n">sweep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">min_lat</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
    <span class="n">max_lat</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
    <span class="n">min_lon</span><span class="o">=-</span><span class="mi">98</span><span class="p">,</span>
    <span class="n">max_lon</span><span class="o">=-</span><span class="mi">97</span><span class="p">,</span>
    <span class="n">lat_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">37.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
    <span class="n">lon_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">98</span><span class="p">,</span> <span class="o">-</span><span class="mf">96.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;twilight_shifted&#39;</span>
<span class="p">)</span>

<span class="c1"># Plot the southeastern radar</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">disp2</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">RadarMapDisplay</span><span class="p">(</span><span class="n">radar_se</span><span class="p">)</span>
<span class="n">disp2</span><span class="o">.</span><span class="n">plot_ppi_map</span><span class="p">(</span>
    <span class="s2">&quot;mean_doppler_velocity&quot;</span><span class="p">,</span>
    <span class="n">sweep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">min_lat</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
    <span class="n">max_lat</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
    <span class="n">min_lon</span><span class="o">=-</span><span class="mi">98</span><span class="p">,</span>
    <span class="n">max_lon</span><span class="o">=-</span><span class="mi">97</span><span class="p">,</span>
    <span class="n">lat_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">37.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
    <span class="n">lon_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">98</span><span class="p">,</span> <span class="o">-</span><span class="mf">96.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;twilight_shifted&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/46368c06d7edd2441318890a0970c8f8/dealiasing_velocities-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/b799f6942d408f2022a569a92a9e9293/dealiasing_velocities-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/c002c4e3b5a34046abf989fddabc88ca/dealiasing_velocities-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/4c2534be2a1e0441e9a2ab0f4d5728b5/dealiasing_velocities-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/dealiasing_velocities-1.png" class="plot-directive" src="../_images/dealiasing_velocities-1.png" />
</figure>
</section>
</section>
<section id="determining-artifacts-within-doppler-velocities">
<h2>Determining Artifacts within Doppler Velocities<a class="headerlink" href="#determining-artifacts-within-doppler-velocities" title="Permalink to this headline">#</a></h2>
<p>Before dealiasing the radar velocities, we need to remove noise and clutter
from the radar objects. Utilizing Py-ART, we will accomplish this by
calculating the velocity texture, or the standard deviation of velocity
surrounding a gate.</p>
<dl class="simple">
<dt>Py-ART’s calculate_velocity_texture function::</dt><dd><p><a class="reference external" href="https://arm-doe.github.io/pyart/API/generated/pyart.retrieve.calculate_velocity_texture.html">https://arm-doe.github.io/pyart/API/generated/pyart.retrieve.calculate_velocity_texture.html</a></p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the Velocity Texture and apply the PyART GateFilter Utilityx</span>
<span class="n">vel_tex_sw</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">retrieve</span><span class="o">.</span><span class="n">calculate_velocity_texture</span><span class="p">(</span><span class="n">radar_sw</span><span class="p">,</span>
                                                       <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;mean_doppler_velocity&#39;</span><span class="p">,</span>
                                                       <span class="n">nyq</span><span class="o">=</span><span class="mi">19</span>
                                                       <span class="p">)</span>
<span class="n">vel_tex_se</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">retrieve</span><span class="o">.</span><span class="n">calculate_velocity_texture</span><span class="p">(</span><span class="n">radar_se</span><span class="p">,</span>
                                                       <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;mean_doppler_velocity&#39;</span><span class="p">,</span>
                                                       <span class="n">nyq</span><span class="o">=</span><span class="mi">19</span>
                                                       <span class="p">)</span>

<span class="c1">## Add velocity texture to the radar objects</span>
<span class="n">radar_sw</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;velocity_texture&#39;</span><span class="p">,</span> <span class="n">vel_tex_sw</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">radar_se</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;velocity_texture&#39;</span><span class="p">,</span> <span class="n">vel_tex_se</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<section id="velocity-texture-displays">
<h3>Velocity Texture Displays<a class="headerlink" href="#velocity-texture-displays" title="Permalink to this headline">#</a></h3>
<p>Let’s see what this velocity texture looks like.
Additionally, a histogram of velocity texture values will allow for
the determination of a threshold to distingiush the hydrometeor signal
from artifacts.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the calculated velocity texture</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">display</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">RadarDisplay</span><span class="p">(</span><span class="n">radar_sw</span><span class="p">)</span>
<span class="n">display</span><span class="o">.</span><span class="n">plot_ppi</span><span class="p">(</span><span class="s1">&#39;velocity_texture&#39;</span><span class="p">,</span>
                     <span class="n">sweep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;twilight_shifted&#39;</span><span class="p">)</span>
                     <span class="p">)</span>

<span class="c1"># Plot a histogram of the velocity textures</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">radar_sw</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;velocity_texture&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">],</span>
                          <span class="n">bins</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span>
         <span class="n">hist</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocity Texture Frequency&#39;</span>
         <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Proposed Velocity Texture Threshold&#39;</span>
            <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Velocity texture&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/2d2ce7778b1fc4d09b806e7a9d4d1d7f/dealiasing_velocities-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id1">
<img alt="../_images/dealiasing_velocities-2_00.png" class="plot-directive" src="../_images/dealiasing_velocities-2_00.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../_downloads/3c40ec94347863e7f5887ad201471b9b/dealiasing_velocities-2_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/df47bcbdc4bfc2fe4b25252302f568e6/dealiasing_velocities-2_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/9b31cb7fac98fb9abfed4664411cf2dd/dealiasing_velocities-2_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<img alt="../_images/dealiasing_velocities-2_01.png" class="plot-directive" src="../_images/dealiasing_velocities-2_01.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../_downloads/10b91d21670abda0bbccf8d0d78ec6ac/dealiasing_velocities-2_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/1cbde6eb3e0b1cdd9121ad5e4cfa121e/dealiasing_velocities-2_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/e02c7624c8610bbef106e774dc84ebc5/dealiasing_velocities-2_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="filter-doppler-velocity-artifacts">
<h3>Filter Doppler Velocity Artifacts<a class="headerlink" href="#filter-doppler-velocity-artifacts" title="Permalink to this headline">#</a></h3>
<p>Now that we have determined which velocity texture values correspond to
artifacts within the doppler velocity data, we utilize Py-ART’s GateFilter
to filter out these artifacts</p>
<dl class="simple">
<dt>Py-ART’s GateFilter function::</dt><dd><p><a class="reference external" href="https://arm-doe.github.io/pyart/API/generated/pyart.filters.GateFilter.html">https://arm-doe.github.io/pyart/API/generated/pyart.filters.GateFilter.html</a></p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply a GateFilter</span>
<span class="n">gatefilter_sw</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">GateFilter</span><span class="p">(</span><span class="n">radar_sw</span><span class="p">)</span>
<span class="n">gatefilter_sw</span><span class="o">.</span><span class="n">exclude_above</span><span class="p">(</span><span class="s1">&#39;velocity_texture&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">gatefilter_se</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">GateFilter</span><span class="p">(</span><span class="n">radar_se</span><span class="p">)</span>
<span class="n">gatefilter_se</span><span class="o">.</span><span class="n">exclude_above</span><span class="p">(</span><span class="s1">&#39;velocity_texture&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="apply-dealiasing">
<h2>Apply Dealiasing<a class="headerlink" href="#apply-dealiasing" title="Permalink to this headline">#</a></h2>
<p>Now that we have removed artifacts, we can proceed with dealiasing
the doppler velocity data with Py-ART’s Region-Based Dealiasing
Algorithm.</p>
<p>The Region-Based Dealiasing finds regions of similar velocities and
unfolds and merges these pairs of regions until all data are unfolded.</p>
<dl class="simple">
<dt>Py-ART’s Region Based Dealiasing Correction::</dt><dd><p><a class="reference external" href="https://arm-doe.github.io/pyart/API/generated/pyart.correct.dealias_region_based.html">https://arm-doe.github.io/pyart/API/generated/pyart.correct.dealias_region_based.html</a></p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply Region Based DeAlising Utiltiy</span>
<span class="n">vel_dealias_sw</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">correct</span><span class="o">.</span><span class="n">dealias_region_based</span><span class="p">(</span><span class="n">radar_sw</span><span class="p">,</span>
                                                    <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;mean_doppler_velocity&#39;</span><span class="p">,</span>
                                                    <span class="n">nyquist_vel</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
                                                    <span class="n">centered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                    <span class="n">gatefilter</span><span class="o">=</span><span class="n">gatefilter_sw</span>
                                                    <span class="p">)</span>

<span class="c1"># Apply Region Based DeAlising Utiltiy</span>
<span class="n">vel_dealias_se</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">correct</span><span class="o">.</span><span class="n">dealias_region_based</span><span class="p">(</span><span class="n">radar_se</span><span class="p">,</span>
                                                    <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;mean_doppler_velocity&#39;</span><span class="p">,</span>
                                                    <span class="n">nyquist_vel</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
                                                    <span class="n">centered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                    <span class="n">gatefilter</span><span class="o">=</span><span class="n">gatefilter_se</span>
                                                    <span class="p">)</span>

<span class="c1"># Add our data dictionary to the radar object</span>
<span class="n">radar_se</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;corrected_velocity&#39;</span><span class="p">,</span> <span class="n">vel_dealias_se</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">radar_sw</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;corrected_velocity&#39;</span><span class="p">,</span> <span class="n">vel_dealias_sw</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<section id="display-corrected-velocity-fields">
<h3>Display Corrected Velocity Fields<a class="headerlink" href="#display-corrected-velocity-fields" title="Permalink to this headline">#</a></h3>
<p>Let’s check on our corrected velocity fields!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot the southwestern radar</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">disp1</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">RadarMapDisplay</span><span class="p">(</span><span class="n">radar_sw</span><span class="p">)</span>
<span class="n">disp1</span><span class="o">.</span><span class="n">plot_ppi_map</span><span class="p">(</span><span class="s2">&quot;corrected_velocity&quot;</span><span class="p">,</span>
                   <span class="n">sweep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                   <span class="n">vmin</span><span class="o">=-</span><span class="mi">35</span><span class="p">,</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span>
                   <span class="n">min_lat</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
                   <span class="n">max_lat</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
                   <span class="n">min_lon</span><span class="o">=-</span><span class="mi">98</span><span class="p">,</span>
                   <span class="n">max_lon</span><span class="o">=-</span><span class="mi">97</span><span class="p">,</span>
                   <span class="n">lat_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">37.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                   <span class="n">lon_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">98</span><span class="p">,</span> <span class="o">-</span><span class="mf">96.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;twilight_shifted&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot the southeastern radar</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">disp2</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">RadarMapDisplay</span><span class="p">(</span><span class="n">radar_se</span><span class="p">)</span>
<span class="n">disp2</span><span class="o">.</span><span class="n">plot_ppi_map</span><span class="p">(</span><span class="s2">&quot;corrected_velocity&quot;</span><span class="p">,</span>
                   <span class="n">sweep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
                   <span class="n">vmin</span><span class="o">=-</span><span class="mi">35</span><span class="p">,</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span>
                   <span class="n">min_lat</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
                   <span class="n">max_lat</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
                   <span class="n">min_lon</span><span class="o">=-</span><span class="mi">98</span><span class="p">,</span>
                   <span class="n">max_lon</span><span class="o">=-</span><span class="mi">97</span><span class="p">,</span>
                   <span class="n">lat_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">37.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                   <span class="n">lon_lines</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">98</span><span class="p">,</span> <span class="o">-</span><span class="mf">96.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;twilight_shifted&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/72dcf01c3ed9308d2c4b149b76b39c30/dealiasing_velocities-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/8d55ead0068800d7c0cc35db6486ea87/dealiasing_velocities-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/eda5b69c015b4e43a80dac8703740a60/dealiasing_velocities-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/3b0dcca1ee8aae58203ca655c717dd80/dealiasing_velocities-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/dealiasing_velocities-3.png" class="plot-directive" src="../_images/dealiasing_velocities-3.png" />
</figure>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>Utilizing Py-ART, we read in two radar files within close proximity to each other.
We then corrected the radar doppler velocities to remove artifacts and clutter.
Finally, utilizing Py-ART, we applied a region-based dealiasing alogrithm to
unfold the doppler velocities</p>
<p>Now that we have corrected velocities, incorporating these radars into PyDDA
will be shown in the next notebook.</p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="read_radar_data.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Reading in Radar Data in Native Radial Coordinates</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="gridding.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Converting the radar data to Cartesian coordinates with Py-ART</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2023, PyDDA Developers.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>