
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Optimizing your wind retrieval &#8212; PyDDA 2.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=f5cff4aa"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/optimizing_wind_retrieval';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualizing the wind retrieval" href="visualizing_winds.html" />
    <link rel="prev" title="Retrieving your first wind field" href="retrieving_winds.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">PyDDA 2.0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributors_guide/index.html">
    Contributor’s Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../source/auto_examples/index.html">
    PyDDA Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev_reference/index.html">
    Developer Reference Manual
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributors_guide/index.html">
    Contributor’s Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../source/auto_examples/index.html">
    PyDDA Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev_reference/index.html">
    Developer Reference Manual
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="read_radar_data.html">Reading in Radar Data in Native Radial Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="dealiasing_velocities.html">Radar Data Quality Control - Dealiasing</a></li>
<li class="toctree-l1"><a class="reference internal" href="gridding.html">Converting the radar data to Cartesian coordinates with Py-ART</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrieving_winds.html">Retrieving your first wind field</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Optimizing your wind retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizing_winds.html">Visualizing the wind retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrieving_winds.html">Retrieving your first wind field</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Optimizing your wind retrieval</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Optimizing...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="optimizing-your-wind-retrieval">
<span id="optimizing-wind-retrieval"></span><h1>Optimizing your wind retrieval<a class="headerlink" href="#optimizing-your-wind-retrieval" title="Link to this heading">#</a></h1>
<p>In the <a class="reference internal" href="retrieving_winds.html#retrieving-winds"><span class="std std-ref">Retrieving your first wind field</span></a> section, we showed how to perform an example wind retrieval
with PyDDA. However, there were some issues to be resolved in the wind retrieval, including
artificial updrafts at the boundaries of the Dual Doppler lobes caused by discontinuities
in the horizontal winds from changing data sources from the radar network to the
model constraint. In this section, we will show how to adjust the parameters of your
wind retrieval in order to minimize such artifacts. First, we will show the wind retrieval
that we did in <a class="reference internal" href="retrieving_winds.html#retrieving-winds"><span class="std std-ref">Retrieving your first wind field</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grids_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">([</span><span class="n">grid_kict</span><span class="p">,</span> <span class="n">grid_ktlx</span><span class="p">],</span>
                                            <span class="n">Cm</span><span class="o">=</span><span class="mf">256.0</span><span class="p">,</span> <span class="n">Co</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">Cx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                            <span class="n">Cz</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Cmod</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">model_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hrrr&quot;</span><span class="p">],</span>
                                            <span class="n">refl_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                            <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">filter_window</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                            <span class="n">filter_order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;scipy&#39;</span><span class="p">)</span>

<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver</span><span class="p">(</span><span class="n">grids_out</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;ChaseSpectral&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
                                 <span class="n">quiverkey_len</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">quiverkey_loc</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/b3813ec10d066addc90e478e331ecdf6/optimizing_wind_retrieval-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<p>We can see several potential issues with the wind retrieval. First, there are artifacts at the
Dual Doppler lobe edges where updrafts are being produced by the optimization code simply
because of a discontinuity in the horizontal winds at the edges of the lobes. In addition,
there are other discontinuities in the horizontal winds that should be addressed. One thing
we can do to mitigate these discontunities is to increase the weight of the horizontal
smoothnes constraints. Therefore, let’s prescribe <code class="code docutils literal notranslate"><span class="pre">Cx</span> <span class="pre">=</span> <span class="pre">100.</span></code> and <code class="code docutils literal notranslate"><span class="pre">Cy</span> <span class="pre">=</span> <span class="pre">100</span></code>
to the above retrieval.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grids_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">([</span><span class="n">grid_kict</span><span class="p">,</span> <span class="n">grid_ktlx</span><span class="p">],</span>
                                            <span class="n">Cm</span><span class="o">=</span><span class="mf">256.0</span><span class="p">,</span> <span class="n">Co</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">Cx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                            <span class="n">Cz</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Cmod</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">model_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hrrr&quot;</span><span class="p">],</span>
                                            <span class="n">refl_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                            <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">filter_window</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                            <span class="n">filter_order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;scipy&#39;</span><span class="p">)</span>

<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver</span><span class="p">(</span><span class="n">grids_out</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;ChaseSpectral&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
                                 <span class="n">quiverkey_len</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">quiverkey_loc</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/7bcf14a70b1f39d9cf42fe1e3ad4c64b/optimizing_wind_retrieval-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<p>As we can see, the artifact at the edge of the Dual Doppler lobe has reduced in size. However, we
also have lost some detail on the updraft structure at this level because the wind field
has been smoothed out. This therefore coarsens the effective resolution of the retrieval.
Let’s see what happens when we increase the level of smoothing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grids_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">([</span><span class="n">grid_kict</span><span class="p">,</span> <span class="n">grid_ktlx</span><span class="p">],</span>
                                            <span class="n">Cm</span><span class="o">=</span><span class="mf">256.0</span><span class="p">,</span> <span class="n">Co</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">Cx</span><span class="o">=</span><span class="mf">250.</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="mf">250.</span><span class="p">,</span>
                                            <span class="n">Cz</span><span class="o">=</span><span class="mf">250.0</span><span class="p">,</span> <span class="n">Cmod</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">model_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hrrr&quot;</span><span class="p">],</span>
                                            <span class="n">refl_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                            <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">filter_window</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                            <span class="n">filter_order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;scipy&#39;</span><span class="p">)</span>

<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver</span><span class="p">(</span><span class="n">grids_out</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;ChaseSpectral&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
                                 <span class="n">quiverkey_len</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">quiverkey_loc</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/d216378631b69b3153a35e2f668f0635/optimizing_wind_retrieval-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<p>In the above retrieval, the updrafts appear to be smoothed out. To help the optimization loop
resolve the updrafts, we recommend, from here, decreasing the tolerance required for the
optimization loop to converge. In addition, decreasing the smoothness will allow more details
of the resolved wind field to appear. In the below example, we observe this, though part of the
artifact near the edge of the Dual Doppler lobe re-appears.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grids_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">([</span><span class="n">grid_kict</span><span class="p">,</span> <span class="n">grid_ktlx</span><span class="p">],</span>
                                            <span class="n">Cm</span><span class="o">=</span><span class="mf">256.0</span><span class="p">,</span> <span class="n">Co</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">Cx</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span>
                                            <span class="n">Cz</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span> <span class="n">Cmod</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">model_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hrrr&quot;</span><span class="p">],</span>
                                            <span class="n">refl_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                            <span class="n">max_iterations</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">filter_window</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                            <span class="n">filter_order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;scipy&#39;</span><span class="p">)</span>

<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver</span><span class="p">(</span><span class="n">grids_out</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;ChaseSpectral&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
                                 <span class="n">quiverkey_len</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;DBZ&#39;</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">quiverkey_loc</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/55f064850a4f3435e219f7c6a38e0ef8/optimizing_wind_retrieval-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<p>Generally, these parameters need to be tuned for your particular radar configuration in
order to obtain the most optimal wind retrieval for your situation. If you are placing
more importance on horizontal winds compared to updraft velocities, then you may be willing
to tolerate more errors in the vertical velocity field so that finer details of the horizontal
wind field can be generated. The above parameters are examples that apply to a 1 km
resolution grid from two NEXRADs and vary for given radar configurations and storm coverages.</p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="retrieving_winds.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Retrieving your first wind field</p>
      </div>
    </a>
    <a class="right-next"
       href="visualizing_winds.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visualizing the wind retrieval</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/user_guide/optimizing_wind_retrieval.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, PyDDA Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>