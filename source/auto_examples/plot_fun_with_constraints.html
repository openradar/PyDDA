

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Example on geographic plotting and constraint variation &#8212; PyDDA 1.5.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/auto_examples/plot_fun_with_constraints';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Developer Reference Manual" href="../../dev_reference/index.html" />
    <link rel="prev" title="Example on retrieving and plotting winds" href="plot_examples.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">PyDDA 1.5.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributors_guide/index.html">
                        Contributor’s Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        PyDDA Example Gallery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev_reference/index.html">
                        Developer Reference Manual
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributors_guide/index.html">
                        Contributor’s Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        PyDDA Example Gallery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev_reference/index.html">
                        Developer Reference Manual
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="plot_sydney_tornado.html">Example of a wind retrieval in a tornado over Sydney</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_examples.html">Example on retrieving and plotting winds</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Example on geographic plotting and constraint variation</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">PyDDA Example Gallery</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Example on...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-source-auto-examples-plot-fun-with-constraints-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="example-on-geographic-plotting-and-constraint-variation">
<span id="sphx-glr-source-auto-examples-plot-fun-with-constraints-py"></span><h1>Example on geographic plotting and constraint variation<a class="headerlink" href="#example-on-geographic-plotting-and-constraint-variation" title="Permalink to this heading">#</a></h1>
<p>In this example we show how to plot wind fields on a map and change
the default constraint coefficients using PyDDA.</p>
<p>This shows how important it is to have the proper intitial state and
constraints when you derive your wind fields. In the first figure,
the sounding was used as the initial state, but for the latter
two examples we use a zero initial state which provides for more
questionable winds at the edges of the Dual Doppler Lobes.</p>
<p>This shows that your initial state and background are key to
providing a physically realistic retrieval. Assuming a zero
background will likely result in false regions of convergence
and divergence that will generate artificial updrafts and downdrafts
at the edges of data coverage.</p>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_fun_with_constraints_001.png" srcset="../../_images/sphx_glr_plot_fun_with_constraints_001.png" alt="PyDDA retreived winds @10.0 km south of origin." class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_fun_with_constraints_002.png" srcset="../../_images/sphx_glr_plot_fun_with_constraints_002.png" alt="PyDDA retreived winds @10.0 km south of origin." class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_fun_with_constraints_003.png" srcset="../../_images/sphx_glr_plot_fun_with_constraints_003.png" alt="PyDDA retreived winds @10.0 km south of origin." class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda3/envs/pydda-docs/lib/python3.10/site-packages/pyart/io/cfradial.py:408: UserWarning: WARNING: valid_min not used since it
cannot be safely cast to variable data type
  data = self.ncvar[:]
/usr/share/miniconda3/envs/pydda-docs/lib/python3.10/site-packages/pyart/io/cfradial.py:408: UserWarning: WARNING: valid_max not used since it
cannot be safely cast to variable data type
  data = self.ncvar[:]
Interpolating sounding to radar grid
Interpolated U field:
tf.Tensor(
[  0.60573435   1.0229144    6.434673    11.977132    12.919597
   9.719978    14.212554    17.673002     9.373551     4.932108
   7.0470777    4.581866     3.8447456    1.9784147   -2.7835784
  -4.8090096   -8.388001    -8.310871    -6.199968    -8.8743305
  -7.5828705   -6.553336    -7.493186    -8.902025   -11.6616335
 -13.175965   -15.263804   -16.580751   -17.48236    -23.17236
 -20.712376   -18.823587   -16.356308   -25.138748   -29.280111
 -28.940443   -19.437548   -10.714591    -9.689518  ], shape=(39,), dtype=float32)
Interpolated V field:
tf.Tensor(
[-6.9235525  -6.326603   -6.434671   -6.9149985  -6.5828586  -3.927123
 -6.6274214  -8.241055   -9.051932   -3.2364333   0.8652741  -1.430016
  0.54577833 -1.4374017  -0.30149823  3.5418017   4.45998     5.19321
  5.667021    7.446448   10.062807   10.487528   11.109102   10.993081
  9.54446    11.055948    9.912431   11.183857    9.295537    2.4355142
 -0.723292   -1.9784379   1.1915643   5.803736    3.5951443  -2.0237138
  2.7317686   6.437976    2.7784247 ], shape=(39,), dtype=float32)
Grid levels:
[ 1000.  1500.  2000.  2500.  3000.  3500.  4000.  4500.  5000.  5500.
  6000.  6500.  7000.  7500.  8000.  8500.  9000.  9500. 10000. 10500.
 11000. 11500. 12000. 12500. 13000. 13500. 14000. 14500. 15000. 15500.
 16000. 16500. 17000. 17500. 18000. 18500. 19000. 19500. 20000.]
/home/runner/work/PyDDA/PyDDA/pydda/retrieval/angles.py:24: RuntimeWarning: invalid value encountered in arccos
  elev = np.arccos((Re**2 + slantrsq - rh**2) / (2 * Re * slantr))
Calculating weights for radars 0 and 1
Calculating weights for radars 1 and 0
Calculating weights for models...
Points from Radar 0: 40597
Points from Radar 1: 40597
Starting solver
rmsVR = 6.827304
Total points: 81194
The max of w_init is 0.0
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
      0|55964.2227|   0.0000|   0.0091|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000
The gradient of the cost functions is 28.291126
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     10| 433.0520|  10.8643|   0.0092|   3.0986|   0.0000|   0.0000|   0.0000|  14.6602
The gradient of the cost functions is 0.9322654
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     20|   7.5696|  11.9199|   0.0093|   3.1923|   0.0000|   0.0000|   0.0000|  14.3516
The gradient of the cost functions is 0.108117804
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     30|   4.4797|  11.2506|   0.0093|   3.2007|   0.0000|   0.0000|   0.0000|  14.2950
The gradient of the cost functions is 0.24360316
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     40|   0.2664|  10.8315|   0.0093|   3.2033|   0.0000|   0.0000|   0.0000|  14.3531
The gradient of the cost functions is 0.258406
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     50|   1.1081|   5.6735|   0.0093|   3.2813|   0.0000|   0.0000|   0.0000|  14.6250
The gradient of the cost functions is 0.061305936
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     60|   1.6095|   4.4080|   0.0093|   3.4170|   0.0000|   0.0000|   0.0000|  15.2762
The gradient of the cost functions is 0.12218659
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     70|   0.0535|   4.3390|   0.0093|   3.3971|   0.0000|   0.0000|   0.0000|  15.1830
The gradient of the cost functions is 0.112230875
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     80|   0.2807|   3.3781|   0.0093|   3.4398|   0.0000|   0.0000|   0.0000|  15.5190
The gradient of the cost functions is 0.051758513
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     90|   1.0581|   2.4080|   0.0093|   3.6301|   0.0000|   0.0000|   0.0000|  16.3007
The gradient of the cost functions is 0.10457411
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    100|   0.0483|   2.4010|   0.0093|   3.5898|   0.0000|   0.0000|   0.0000|  16.2115
The gradient of the cost functions is 0.049456704
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    110|   0.0814|   2.2034|   0.0093|   3.6100|   0.0000|   0.0000|   0.0000|  16.3215
The gradient of the cost functions is 0.049815755
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    120|   0.6869|   1.5476|   0.0093|   3.7707|   0.0000|   0.0000|   0.0000|  17.0703
The gradient of the cost functions is 0.10846455
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    130|   0.0268|   1.5556|   0.0093|   3.7333|   0.0000|   0.0000|   0.0000|  16.9280
The gradient of the cost functions is 0.027292885
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    140|   0.0306|   1.4981|   0.0093|   3.7383|   0.0000|   0.0000|   0.0000|  16.9617
The gradient of the cost functions is 0.042717613
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    150|   0.4080|   1.1065|   0.0093|   3.7895|   0.0000|   0.0000|   0.0000|  17.2925
The gradient of the cost functions is 0.10312765
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    160|   0.0236|   1.1075|   0.0093|   3.7809|   0.0000|   0.0000|   0.0000|  17.2615
The gradient of the cost functions is 0.01871165
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    170|   0.0207|   1.0828|   0.0093|   3.7814|   0.0000|   0.0000|   0.0000|  17.2774
The gradient of the cost functions is 0.031389352
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    180|   0.2004|   0.8937|   0.0093|   3.7681|   0.0000|   0.0000|   0.0000|  17.8297
The gradient of the cost functions is 0.114162244
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    190|   0.0271|   0.8746|   0.0093|   3.7660|   0.0000|   0.0000|   0.0000|  18.4548
The gradient of the cost functions is 0.014707348
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    200|   0.0090|   0.8632|   0.0093|   3.7637|   0.0000|   0.0000|   0.0000|  18.8838
The gradient of the cost functions is 0.01655056
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    210|   0.0497|   0.8166|   0.0093|   3.7508|   0.0000|   0.0000|   0.0000|  19.4606
The gradient of the cost functions is 0.1292962
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    220|   0.0408|   0.7467|   0.0093|   3.7189|   0.0000|   0.0000|   0.0000|  20.9271
The gradient of the cost functions is 0.014018058
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    230|   0.0077|   0.7449|   0.0093|   3.7053|   0.0000|   0.0000|   0.0000|  21.6975
Applying low pass filter to wind field...
Done! Time = 304.3
Interpolating sounding to radar grid
Grid levels:
[ 1000.  1500.  2000.  2500.  3000.  3500.  4000.  4500.  5000.  5500.
  6000.  6500.  7000.  7500.  8000.  8500.  9000.  9500. 10000. 10500.
 11000. 11500. 12000. 12500. 13000. 13500. 14000. 14500. 15000. 15500.
 16000. 16500. 17000. 17500. 18000. 18500. 19000. 19500. 20000.]
/home/runner/work/PyDDA/PyDDA/pydda/retrieval/angles.py:24: RuntimeWarning: invalid value encountered in arccos
  elev = np.arccos((Re**2 + slantrsq - rh**2) / (2 * Re * slantr))
Calculating weights for radars 0 and 1
Calculating weights for radars 1 and 0
Calculating weights for models...
Starting solver
rmsVR = 6.827303971100176
Total points: 81194
The max of w_init is 0.0
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
      0|83859.8222|   0.0000|   0.0000|1274.4286|   0.0000|   0.0000|   0.0000|   0.0000
The gradient of the cost functions is 5.038254523235252
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     10| 104.6122|   9.3710|   0.0001|1260.2205|   0.0000|   0.0000|   0.0000|  11.2844
Max change in w: 10.043
The gradient of the cost functions is 0.775161118954335
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     20|  61.5866|   9.0864|   0.0001|1207.0215|   0.0000|   0.0000|   0.0000|  10.9054
Max change in w: 2.754
The gradient of the cost functions is 0.9587490136345419
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     30|  60.0826|   8.9521|   0.0001|1082.5995|   0.0000|   0.0000|   0.0000|  10.5953
Max change in w: 2.797
The gradient of the cost functions is 1.0049961619020986
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     40|  72.9851|  11.2030|   0.0001| 815.5149|   0.0000|   0.0000|   0.0000|   9.9708
Max change in w: 2.913
The gradient of the cost functions is 1.0202780679847934
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     50|  66.1997|  13.1086|   0.0002| 519.6157|   0.0000|   0.0000|   0.0000|  10.2865
Max change in w: 3.427
The gradient of the cost functions is 1.4100408148787973
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     60|  66.8580|  12.1708|   0.0002| 310.6957|   0.0000|   0.0000|   0.0000|   9.2334
Max change in w: 2.611
The gradient of the cost functions is 0.8024663887758341
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     70|  63.7697|  11.4330|   0.0001| 166.5865|   0.0000|   0.0000|   0.0000|   8.3978
Max change in w: 2.202
The gradient of the cost functions is 0.6370206117050153
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     80|  58.0690|   9.5843|   0.0001| 112.3192|   0.0000|   0.0000|   0.0000|   7.5988
Max change in w: 1.939
The gradient of the cost functions is 0.32017408487308424
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     90|  55.3679|   8.0417|   0.0001|  92.7272|   0.0000|   0.0000|   0.0000|   6.4873
Max change in w: 1.583
The gradient of the cost functions is 0.3434891563212762
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    100|  56.2246|   7.1911|   0.0001|  85.4336|   0.0000|   0.0000|   0.0000|   6.6487
Max change in w: 0.709
The gradient of the cost functions is 0.20647137687483463
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    110|  55.0108|   6.5672|   0.0001|  81.7367|   0.0000|   0.0000|   0.0000|   7.0601
Max change in w: 0.774
The gradient of the cost functions is 0.21612435806728586
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    120|  54.9904|   6.1487|   0.0001|  79.3023|   0.0000|   0.0000|   0.0000|   7.3839
The gradient of the cost functions is 0.14185532542095114
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    130|  54.9293|   5.8913|   0.0001|  78.8354|   0.0000|   0.0000|   0.0000|   7.5769
Max change in w: 0.670
The gradient of the cost functions is 0.23061951091558958
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    140|  54.8454|   5.8029|   0.0001|  78.8547|   0.0000|   0.0000|   0.0000|   7.7130
The gradient of the cost functions is 0.11280192894332923
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    150|  54.8203|   5.8175|   0.0001|  78.8463|   0.0000|   0.0000|   0.0000|   7.6908
The gradient of the cost functions is 0.10656236866484606
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    160|  54.8088|   5.8167|   0.0001|  78.8464|   0.0000|   0.0000|   0.0000|   7.6880
The gradient of the cost functions is 0.11841483543015843
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    170|  54.7839|   5.8066|   0.0001|  78.8485|   0.0000|   0.0000|   0.0000|   7.6871
The gradient of the cost functions is 0.11841819633403929
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    180|  54.7839|   5.8066|   0.0001|  78.8485|   0.0000|   0.0000|   0.0000|   7.6871
The gradient of the cost functions is 0.07982751076265411
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    190|  54.7598|   5.8024|   0.0001|  78.8498|   0.0000|   0.0000|   0.0000|   7.6997
The gradient of the cost functions is 0.0794424368524094
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    200|  54.7598|   5.8024|   0.0001|  78.8498|   0.0000|   0.0000|   0.0000|   7.6997
The gradient of the cost functions is 0.05063874347969569
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    210|  54.7596|   5.8017|   0.0001|  78.8500|   0.0000|   0.0000|   0.0000|   7.6972
The gradient of the cost functions is 0.053970286964475804
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    220|  54.7595|   5.8018|   0.0001|  78.8500|   0.0000|   0.0000|   0.0000|   7.6973
The gradient of the cost functions is 0.05377543310188353
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    230|  54.7595|   5.8018|   0.0001|  78.8500|   0.0000|   0.0000|   0.0000|   7.6973
The gradient of the cost functions is 0.05397028764853967
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    240|  54.7595|   5.8018|   0.0001|  78.8500|   0.0000|   0.0000|   0.0000|   7.6973
Applying low pass filter to wind field...
Done! Time = 183.5
Interpolating sounding to radar grid
Grid levels:
[ 1000.  1500.  2000.  2500.  3000.  3500.  4000.  4500.  5000.  5500.
  6000.  6500.  7000.  7500.  8000.  8500.  9000.  9500. 10000. 10500.
 11000. 11500. 12000. 12500. 13000. 13500. 14000. 14500. 15000. 15500.
 16000. 16500. 17000. 17500. 18000. 18500. 19000. 19500. 20000.]
/home/runner/work/PyDDA/PyDDA/pydda/retrieval/angles.py:24: RuntimeWarning: invalid value encountered in arccos
  elev = np.arccos((Re**2 + slantrsq - rh**2) / (2 * Re * slantr))
Calculating weights for radars 0 and 1
Calculating weights for radars 1 and 0
Calculating weights for models...
Starting solver
rmsVR = 6.827303971100176
Total points: 81194
The max of w_init is 0.0
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
      0|559642.2711|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000
The gradient of the cost functions is 5.427886626946507
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     10| 212.2427|  10.9751|   0.0002|   3.5672|   0.0000|   0.0000|   0.0000|  14.0506
Max change in w: 7.303
The gradient of the cost functions is 4.086576199279208
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     20|  46.7416|  11.0621|   0.0002|   3.4229|   0.0000|   0.0000|   0.0000|  13.8649
The gradient of the cost functions is 4.176883039099318
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     30|  46.5887|  11.0627|   0.0002|   3.4211|   0.0000|   0.0000|   0.0000|  13.8654
The gradient of the cost functions is 4.5512339092648695
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     40|  45.9931|  10.8450|   0.0002|   3.5886|   0.0000|   0.0000|   0.0000|  13.9134
The gradient of the cost functions is 3.8464983407396365
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     50|  46.0035|  10.8261|   0.0002|   3.6063|   0.0000|   0.0000|   0.0000|  13.9204
The gradient of the cost functions is 3.896109235900245
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     60|  45.7845|  10.8005|   0.0002|   3.6319|   0.0000|   0.0000|   0.0000|  13.9176
The gradient of the cost functions is 3.822799753495727
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     70|  45.7165|  10.7653|   0.0002|   3.6695|   0.0000|   0.0000|   0.0000|  13.9193
The gradient of the cost functions is 3.7790608184861867
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     80|  45.6937|  10.7431|   0.0002|   3.6930|   0.0000|   0.0000|   0.0000|  13.9206
The gradient of the cost functions is 3.6057232940399837
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     90|  43.7130|  10.4327|   0.0002|   4.2235|   0.0000|   0.0000|   0.0000|  13.9238
Max change in w: 2.178
The gradient of the cost functions is 3.2279150203545353
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    100|  86.5244|  12.3547|   0.0002|  14.2928|   0.0000|   0.0000|   0.0000|  15.6096
The gradient of the cost functions is 4.6813812592392825
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    110|  16.4134|  11.7874|   0.0002|  14.0740|   0.0000|   0.0000|   0.0000|  15.4837
The gradient of the cost functions is 3.353139834242404
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    120|  15.9922|  11.6178|   0.0002|  14.4650|   0.0000|   0.0000|   0.0000|  15.4784
The gradient of the cost functions is 3.353039695037897
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    130|  15.9923|  11.6178|   0.0002|  14.4650|   0.0000|   0.0000|   0.0000|  15.4784
Max change in w: 3.567
The gradient of the cost functions is 2.6518855843943383
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    140|  12.6556|  11.4792|   0.0002|  14.4755|   0.0000|   0.0000|   0.0000|  15.4507
The gradient of the cost functions is 2.595068428540628
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    150|  12.6898|  11.4206|   0.0002|  14.4811|   0.0000|   0.0000|   0.0000|  15.4368
The gradient of the cost functions is 2.5750178694653623
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    160|  12.6992|  11.3919|   0.0002|  14.4842|   0.0000|   0.0000|   0.0000|  15.4295
The gradient of the cost functions is 2.5579536259677687
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    170|  27.9693|   9.4195|   0.0002|  15.1769|   0.0000|   0.0000|   0.0000|  14.4885
The gradient of the cost functions is 2.557952315829534
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    180|  12.7666|  11.2800|   0.0002|  14.4986|   0.0000|   0.0000|   0.0000|  15.3983
The gradient of the cost functions is 2.55795362596754
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    190|  11.9437|  11.2431|   0.0002|  14.5033|   0.0000|   0.0000|   0.0000|  15.3874
The gradient of the cost functions is 2.2737146657417293
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    200|  11.9904|  11.1657|   0.0002|  14.5142|   0.0000|   0.0000|   0.0000|  15.3643
The gradient of the cost functions is 2.267873831279812
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    210|  11.9847|  11.1677|   0.0002|  14.5139|   0.0000|   0.0000|   0.0000|  15.3649
The gradient of the cost functions is 5.262518408711945
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    220|  12.8357|  10.8827|   0.0002|  14.5641|   0.0000|   0.0000|   0.0000|  15.2737
The gradient of the cost functions is 2.1636934638316068
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    230|  11.7827|  11.1085|   0.0002|  14.5236|   0.0000|   0.0000|   0.0000|  15.3468
The gradient of the cost functions is 2.1216939188751107
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    240|  12.1133|  10.9513|   0.0002|  14.5508|   0.0000|   0.0000|   0.0000|  15.2955
The gradient of the cost functions is 1.6684862823793694
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    250| 314.6392|   8.9431|   0.0002|  16.2219|   0.0000|   0.0000|   0.0000|  13.5202
The gradient of the cost functions is 1.6576334225483755
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    260|  12.0696|  10.4976|   0.0002|  14.6543|   0.0000|   0.0000|   0.0000|  15.1255
Max change in w: 1.384
The gradient of the cost functions is 1.6581971346710367
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    270|  12.0701|  10.4972|   0.0002|  14.6545|   0.0000|   0.0000|   0.0000|  15.1253
The gradient of the cost functions is 1.6594879563724008
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    280|  12.0696|  10.4976|   0.0002|  14.6543|   0.0000|   0.0000|   0.0000|  15.1255
The gradient of the cost functions is 1.64398623717688
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    290|  29.6884|   8.9026|   0.0002|  16.1302|   0.0000|   0.0000|   0.0000|  13.6062
The gradient of the cost functions is 1.6439835595630419
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    300|  12.0750|  10.4833|   0.0002|  14.6601|   0.0000|   0.0000|   0.0000|  15.1175
The gradient of the cost functions is 1.6439862371764329
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    310|  12.0976|  10.4638|   0.0002|  14.6680|   0.0000|   0.0000|   0.0000|  15.1065
The gradient of the cost functions is 1.6439862243907881
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    320|  12.0750|  10.4833|   0.0002|  14.6601|   0.0000|   0.0000|   0.0000|  15.1175
The gradient of the cost functions is 1.6439862371768446
Applying low pass filter to wind field...
Done! Time = 184.6
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pydda</span>
<span class="kn">import</span> <span class="nn">pyart</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">berr_grid</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_grid</span><span class="p">(</span><span class="n">pydda</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">EXAMPLE_RADAR0</span><span class="p">)</span>
<span class="n">cpol_grid</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_grid</span><span class="p">(</span><span class="n">pydda</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">EXAMPLE_RADAR1</span><span class="p">)</span>

<span class="c1"># Load our radar data</span>
<span class="n">sounding</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_arm_sonde</span><span class="p">(</span><span class="n">pydda</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">SOUNDING_PATH</span><span class="p">)</span>
<span class="n">berr_grid</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_constant_wind_field</span><span class="p">(</span><span class="n">berr_grid</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>

<span class="c1"># Let&#39;s provide an initial state from the sounding</span>
<span class="n">u_back</span> <span class="o">=</span> <span class="n">sounding</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">u_wind</span>
<span class="n">v_back</span> <span class="o">=</span> <span class="n">sounding</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">v_wind</span>
<span class="n">z_back</span> <span class="o">=</span> <span class="n">sounding</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span>
<span class="n">cpol_grid</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_wind_field_from_profile</span><span class="p">(</span><span class="n">cpol_grid</span><span class="p">,</span> <span class="n">sounding</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">new_grids</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">(</span>
    <span class="p">[</span><span class="n">cpol_grid</span><span class="p">,</span> <span class="n">berr_grid</span><span class="p">],</span>
    <span class="n">u_back</span><span class="o">=</span><span class="n">u_back</span><span class="p">,</span>
    <span class="n">v_back</span><span class="o">=</span><span class="n">v_back</span><span class="p">,</span>
    <span class="n">z_back</span><span class="o">=</span><span class="n">z_back</span><span class="p">,</span>
    <span class="n">Co</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">Cm</span><span class="o">=</span><span class="mf">64.0</span><span class="p">,</span>
    <span class="n">frz</span><span class="o">=</span><span class="mf">5000.0</span><span class="p">,</span>
    <span class="n">Cb</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">Cx</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">Cy</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">Cz</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">mask_outside_opt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_xz_xsection_streamlines</span><span class="p">(</span>
    <span class="n">new_grids</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Let&#39;s see what happens when we use a zero initialization</span>
<span class="c1"># This causes there to be convergence in the cone of silence</span>
<span class="c1"># This is an artifact that we want to avoid!</span>
<span class="c1"># Prescribing winds inside the background through either a constraint</span>
<span class="c1"># Or through the initial state will help mitigate this issue.</span>
<span class="n">cpol_grid</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_constant_wind_field</span><span class="p">(</span><span class="n">cpol_grid</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">new_grids</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">(</span>
    <span class="p">[</span><span class="n">cpol_grid</span><span class="p">,</span> <span class="n">berr_grid</span><span class="p">],</span>
    <span class="n">u_back</span><span class="o">=</span><span class="n">u_back</span><span class="p">,</span>
    <span class="n">v_back</span><span class="o">=</span><span class="n">v_back</span><span class="p">,</span>
    <span class="n">z_back</span><span class="o">=</span><span class="n">z_back</span><span class="p">,</span>
    <span class="n">Co</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">Cm</span><span class="o">=</span><span class="mf">64.0</span><span class="p">,</span>
    <span class="n">frz</span><span class="o">=</span><span class="mf">5000.0</span><span class="p">,</span>
    <span class="n">Cb</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">Cx</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">Cy</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">Cz</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">mask_outside_opt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;scipy&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_xz_xsection_streamlines</span><span class="p">(</span>
    <span class="n">new_grids</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Or, let&#39;s make the radar data more important!</span>
<span class="n">cpol_grid</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_wind_field_from_profile</span><span class="p">(</span><span class="n">cpol_grid</span><span class="p">,</span> <span class="n">sounding</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">new_grids</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">(</span>
    <span class="p">[</span><span class="n">cpol_grid</span><span class="p">,</span> <span class="n">berr_grid</span><span class="p">],</span>
    <span class="n">Co</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">Cm</span><span class="o">=</span><span class="mf">64.0</span><span class="p">,</span>
    <span class="n">frz</span><span class="o">=</span><span class="mf">5000.0</span><span class="p">,</span>
    <span class="n">u_back</span><span class="o">=</span><span class="n">u_back</span><span class="p">,</span>
    <span class="n">v_back</span><span class="o">=</span><span class="n">v_back</span><span class="p">,</span>
    <span class="n">z_back</span><span class="o">=</span><span class="n">z_back</span><span class="p">,</span>
    <span class="n">Cb</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">Cx</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">Cy</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">Cz</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
    <span class="n">mask_outside_opt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;scipy&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_xz_xsection_streamlines</span><span class="p">(</span>
    <span class="n">new_grids</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (11 minutes 15.942 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-source-auto-examples-plot-fun-with-constraints-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/564db4ff92b5949f5865201b6023e7a2/plot_fun_with_constraints.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_fun_with_constraints.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/69088b28623951c8bc5bf24f02f5316d/plot_fun_with_constraints.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_fun_with_constraints.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_examples.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Example on retrieving and plotting winds</p>
      </div>
    </a>
    <a class="right-next"
       href="../../dev_reference/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Developer Reference Manual</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/source/auto_examples/plot_fun_with_constraints.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, PyDDA Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>