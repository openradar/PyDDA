
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Example of a wind retrieval in a tornado over Sydney &#8212; PyDDA 1.3.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Example on geographic plotting and constraint variation" href="plot_fun_with_constraints.html" />
    <link rel="prev" title="Example on retrieving and plotting winds" href="plot_examples.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../index.html">
<p class="title">PyDDA</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../contributors_guide/index.html">
  Contributorâ€™s Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  PyDDA Example Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../dev_reference/index.html">
  Developer Reference Manual
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="hurricane_florence.html">
   Example on integrating radar and HRRR data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_examples.html">
   Example on retrieving and plotting winds
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Example of a wind retrieval in a tornado over Sydney
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_fun_with_constraints.html">
   Example on geographic plotting and constraint variation
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-source-auto-examples-plot-sydney-tornado-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="example-of-a-wind-retrieval-in-a-tornado-over-sydney">
<span id="sphx-glr-source-auto-examples-plot-sydney-tornado-py"></span><h1>Example of a wind retrieval in a tornado over Sydney<a class="headerlink" href="#example-of-a-wind-retrieval-in-a-tornado-over-sydney" title="Permalink to this headline">#</a></h1>
<p>This shows an example of how to retrieve winds from 4 radars over Sydney.</p>
<p>We use smoothing to decrease the magnitude of the updraft in the region of
the mesocyclone. The reduction of noise also helps the solution converge
much faster since the cost function is smoother and therefore less susecptible
to find a local minimum that is in noise.</p>
<p>The observational constraint is reduced to 0.01 from the usual 1because we are factoring in
many more data points as we are using 4 radars instead of the two in the Darwin example.</p>
<p>This example uses pooch to download the data files.</p>
<img alt="../../_images/sydney_tornado.png" src="../../_images/sydney_tornado.png" />
<img src="../../_images/sphx_glr_plot_sydney_tornado_001.png" srcset="../../_images/sphx_glr_plot_sydney_tornado_001.png" alt="PyDDA retreived winds @4.383 km" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda3/envs/pydda-docs/lib/python3.11/site-packages/pyart/io/cfradial.py:408: UserWarning: WARNING: valid_min not used since it
cannot be safely cast to variable data type
  data = self.ncvar[:]
/usr/share/miniconda3/envs/pydda-docs/lib/python3.11/site-packages/pyart/io/cfradial.py:408: UserWarning: WARNING: valid_max not used since it
cannot be safely cast to variable data type
  data = self.ncvar[:]
Calculating weights for radars 0 and 1
Calculating weights for radars 0 and 2
Calculating weights for radars 0 and 3
Calculating weights for radars 1 and 0
Calculating weights for radars 1 and 2
Calculating weights for radars 1 and 3
Calculating weights for radars 2 and 0
Calculating weights for radars 2 and 1
Calculating weights for radars 2 and 3
Calculating weights for radars 3 and 0
Calculating weights for radars 3 and 1
Calculating weights for radars 3 and 2
Calculating weights for models...
Points from Radar 0: 68927
Points from Radar 1: 82785
Points from Radar 2: 64605
Points from Radar 3: 64959
Starting solver
rmsVR = 7.24225
Total points: 281276
The max of w_init is 0.0
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
      0|2864.7900|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000
The gradient of the cost functions is 1.5443492
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     10| 160.7619|  84.6624|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  19.8056
The gradient of the cost functions is 0.11083611
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     20|  67.2361|  40.4497|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.9986
The gradient of the cost functions is 0.046650108
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     30|  74.9021|  31.8725|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  87.2355
The gradient of the cost functions is 0.16772418
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     40|  53.7402|  21.6132|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  88.5672
The gradient of the cost functions is 0.039173342
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     50|  49.7931|  17.5485|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 106.1469
The gradient of the cost functions is 0.023509864
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     60|  50.2131|  16.8178|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 145.9839
The gradient of the cost functions is 0.09374788
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     70|  45.3509|  13.8503|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 153.9241
The gradient of the cost functions is 0.027020399
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     80|  43.1789|  12.4852|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 176.4540
The gradient of the cost functions is 0.017706629
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
     90|  42.9505|  12.1104|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 211.0336
The gradient of the cost functions is 0.073807366
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    100|  40.3303|  10.7333|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 221.5479
The gradient of the cost functions is 0.022351442
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    110|  38.8250|   9.8692|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 247.0874
The gradient of the cost functions is 0.015094837
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    120|  38.3343|   9.8641|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 308.7441
The gradient of the cost functions is 0.06109772
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    130|  36.4593|   8.8712|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 331.2395
The gradient of the cost functions is 0.019810997
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    140|  35.1107|   8.4133|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 387.6579
The gradient of the cost functions is 0.013441316
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    150|  34.4118|   8.5971|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 470.7531
The gradient of the cost functions is 0.054734387
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    160|  32.9937|   7.8767|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 497.6726
The gradient of the cost functions is 0.017656278
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    170|  31.8791|   7.5525|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 560.2026
The gradient of the cost functions is 0.012031976
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    180|  31.3087|   7.7279|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 649.6065
The gradient of the cost functions is 0.047821913
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    190|  30.1715|   7.1526|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 676.6850
The gradient of the cost functions is 0.015947402
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    200|  29.2386|   6.9574|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 739.9429
The gradient of the cost functions is 0.010787779
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    210|  28.7032|   7.2065|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 831.8099
The gradient of the cost functions is 0.043327026
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    220|  27.7870|   6.7180|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 857.8863
The gradient of the cost functions is 0.014088896
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    230|  27.0351|   6.5782|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 919.1457
The gradient of the cost functions is 0.009548959
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    240|  26.6050|   6.8166|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1005.9415
The gradient of the cost functions is 0.038505632
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    250|  25.8553|   6.4350|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1029.0482
The gradient of the cost functions is 0.012485673
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    260|  25.2462|   6.3516|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1083.9883
The gradient of the cost functions is 0.008461924
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    270|  24.8755|   6.5834|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1159.2755
The gradient of the cost functions is 0.034072217
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    280|  24.2880|   6.2752|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1179.3236
The gradient of the cost functions is 0.011349832
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    290|  23.7788|   6.2063|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1228.2101
The gradient of the cost functions is 0.007855405
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    300|  23.4562|   6.3997|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1297.5356
The gradient of the cost functions is 0.032471403
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    310|  22.9405|   6.1303|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1314.6139
The gradient of the cost functions is 0.010743443
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    320|  22.5054|   6.0578|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1356.9799
The gradient of the cost functions is 0.0073547303
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    330|  22.2549|   6.1879|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1413.1760
The gradient of the cost functions is 0.029959224
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    340|  21.8069|   5.9618|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1427.7045
The gradient of the cost functions is 0.009906556
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    350|  21.4343|   5.8864|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1461.0905
The gradient of the cost functions is 0.0069369487
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    360|  21.2237|   5.9827|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1503.4631
The gradient of the cost functions is 0.028667746
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    370|  20.8370|   5.7814|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1514.0259
The gradient of the cost functions is 0.009357173
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    380|  20.5119|   5.7149|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1537.2170
The gradient of the cost functions is 0.006426818
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    390|  20.3290|   5.8006|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1564.5397
The gradient of the cost functions is 0.02592759
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    400|  19.9954|   5.6250|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1570.4498
The gradient of the cost functions is 0.008685899
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    410|  19.7176|   5.5622|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1583.1708
The gradient of the cost functions is 0.005967927
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    420|  19.5569|   5.6341|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1595.7274
The gradient of the cost functions is 0.024018707
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    430|  19.2753|   5.4834|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1597.6135
The gradient of the cost functions is 0.008230817
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    440|  19.0312|   5.4319|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1600.8894
The gradient of the cost functions is 0.0056738057
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    450|  18.8791|   5.5030|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1600.8486
The gradient of the cost functions is 0.02298888
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    460|  18.6180|   5.3679|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1598.9517
The gradient of the cost functions is 0.007739951
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    470|  18.3886|   5.3224|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1593.4803
The gradient of the cost functions is 0.0054327347
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    480|  18.2515|   5.3871|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1581.7062
The gradient of the cost functions is 0.021888722
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    490|  18.0285|   5.2617|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1576.7397
The gradient of the cost functions is 0.0072399112
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    500|  17.8319|   5.2227|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1564.3191
The gradient of the cost functions is 0.0050076796
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    510|  17.7196|   5.2767|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1543.0151
The gradient of the cost functions is 0.020155214
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    520|  17.5154|   5.1719|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1535.5204
The gradient of the cost functions is 0.0067139613
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    530|  17.3468|   5.1364|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1517.5198
The gradient of the cost functions is 0.0047206064
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    540|  17.2475|   5.1898|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1489.2612
The gradient of the cost functions is 0.018979384
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    550|  17.0698|   5.0946|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1480.1777
The gradient of the cost functions is 0.006368702
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    560|  16.9203|   5.0603|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1457.8083
The gradient of the cost functions is 0.004448607
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    570|  16.8384|   5.0961|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1424.1523
The gradient of the cost functions is 0.018531704
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    580|  16.6769|   5.0091|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1413.4814
The gradient of the cost functions is 0.0061640223
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    590|  16.5429|   4.9750|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1388.7900
The gradient of the cost functions is 0.0043050284
Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w
    600|  16.4637|   5.0097|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|1352.7836
Applying low pass filter to wind field...
Done! Time = 1950.9
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyart</span>
<span class="kn">import</span> <span class="nn">pydda</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pooch</span>

<span class="n">grid1_path</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/grid1_sydney.nc&quot;</span><span class="p">,</span>
    <span class="n">known_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">grid2_path</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/grid2_sydney.nc&quot;</span><span class="p">,</span>
    <span class="n">known_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">grid3_path</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/grid3_sydney.nc&quot;</span><span class="p">,</span>
    <span class="n">known_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">grid4_path</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/grid4_sydney.nc&quot;</span><span class="p">,</span>
    <span class="n">known_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">grid1</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_grid</span><span class="p">(</span><span class="n">grid1_path</span><span class="p">)</span>
<span class="n">grid2</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_grid</span><span class="p">(</span><span class="n">grid2_path</span><span class="p">)</span>
<span class="n">grid3</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_grid</span><span class="p">(</span><span class="n">grid3_path</span><span class="p">)</span>
<span class="n">grid4</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_grid</span><span class="p">(</span><span class="n">grid4_path</span><span class="p">)</span>

<span class="c1"># Set initialization and do retrieval</span>
<span class="n">grid1</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_constant_wind_field</span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;VRADH_corr&#39;</span><span class="p">)</span>
<span class="n">new_grids</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">([</span><span class="n">grid1</span><span class="p">,</span> <span class="n">grid2</span><span class="p">,</span> <span class="n">grid3</span><span class="p">,</span> <span class="n">grid4</span><span class="p">],</span>
                                                 <span class="n">Co</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">256.0</span><span class="p">,</span> <span class="n">Cx</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
                                                 <span class="n">Cz</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
                                                 <span class="n">vel_name</span><span class="o">=</span><span class="s1">&#39;VRADH_corr&#39;</span><span class="p">,</span> <span class="n">refl_field</span><span class="o">=</span><span class="s1">&#39;DBZH&#39;</span><span class="p">,</span>
                                                 <span class="n">mask_outside_opt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wind_tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                                 <span class="n">max_iterations</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                                                 <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;tensorflow&#39;</span><span class="p">)</span>
<span class="c1"># Make a neat plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;DBZH&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                              <span class="n">show_lobes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                                              <span class="n">quiverkey_len</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">w_vel_contours</span><span class="o">=</span><span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
                                              <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                                              <span class="n">quiverkey_loc</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">150.5</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">36</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">151.0</span><span class="p">,</span> <span class="mf">151.35</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">34.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.9</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 32 minutes  42.199 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-source-auto-examples-plot-sydney-tornado-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e723312fcafc897d55179a96edaf58b4/plot_sydney_tornado.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sydney_tornado.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/535f32d48be9613371513d85cd515759/plot_sydney_tornado.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sydney_tornado.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="plot_examples.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Example on retrieving and plotting winds</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="plot_fun_with_constraints.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Example on geographic plotting and constraint variation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2023, PyDDA Developers.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>